<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Squidstat API User Manual: Python Example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Admiral_Instruments_Logo.webp"/></td>
  <td id="projectalign">
   <div id="projectname">Squidstat API User Manual
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_intro_and_examples_9__python_example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Python Example </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="pythonExample"></a></p>
<h3><a class="anchor" id="autotoc_md28"></a>
Introduction</h3>
<p >The following example will help illustrate the use of the SquidstatPyLibrary with Python. SquidstatPyLibrary is currently supported on windows platform.</p>
<h3><a class="anchor" id="autotoc_md29"></a>
How To Use Squidstatlibrary with Python.</h3>
<ol type="1">
<li>To use the SquidstatPyLibrary library, you need to install Python version &gt;= 3.7 and &lt; 3.11.<ul>
<li>Visit the official Python website at <a href="https://www.python.org/downloads/">https://www.python.org/downloads/</a>.</li>
<li>Download the installer for the desired Python version (&gt;= 3.7 and &lt; 3.11).</li>
<li>Run the installer and follow the installation wizard's instructions.</li>
<li>Make sure to select the option to add Python to the system environmental (PATH) variables during the installation process. This will enable you to run Python from any location on your computer.</li>
</ul>
</li>
<li>Make sure you have installed Python correctly by checking the Python version using <code>python -V</code> command.</li>
<li>Now you can choose to install the library in either the global environment or a virtual environment. If you want to install the library in the global environment, you can skip this step.<ul>
<li>If you prefer using a virtual environment, you can create a virtual environment by running the command: <code>python -m venv VIRTUAL_ENVIRONMENT_NAME</code></li>
<li>Open the command prompt and activate the virtual environment by typing: <code>./VIRTUAL_ENVIRONMENT_NAME/Scripts/activate.bat</code></li>
</ul>
</li>
<li>Now you can proceed to install the SquidstatPyLibrary. You can download the .whl file from <a href="https://github.com/Admiral-Instruments/AdmiralSquidstatAPI/tree/main/SquidstatLibrary/windows/pythonWrapper/Release">here</a>. After downloading, you can install it using the command <code>pip install YOUR_DOWNLOADED_FILE.whl</code></li>
<li>Now, let's run an example script. If you have an Experiment.py file that you created to run an experiment, you can execute that script by using the command <code>python Experiment.py</code>.</li>
</ol>
<p >The necessary Python library files are also located inside the <a href="https://github.com/Admiral-Instruments/AdmiralSquidstatAPI/tree/main/SquidstatLibrary/windows/pythonWrapper/Release">pythonWrapper</a> directory.</p>
<p >Now We will go through an example of building and running an experiment.</p>
<h3><a class="anchor" id="autotoc_md30"></a>
Building a Custom Experiment with Python</h3>
<h4><a class="anchor" id="autotoc_md31"></a>
Import all the required basic modules from SquidstatPyLibrary.</h4>
<div class="fragment"><div class="line"><span class="keyword">import</span> sys</div>
<div class="line"><span class="keyword">import</span> struct</div>
<div class="line"><span class="keyword">from</span> PySide2.QtWidgets <span class="keyword">import</span> QApplication</div>
<div class="line"><span class="keyword">from</span> SquidstatPyLibrary <span class="keyword">import</span> AisDeviceTracker</div>
<div class="line"><span class="keyword">from</span> SquidstatPyLibrary <span class="keyword">import</span> AisCompRange</div>
<div class="line"><span class="keyword">from</span> SquidstatPyLibrary <span class="keyword">import</span> AisDCData</div>
<div class="line"><span class="keyword">from</span> SquidstatPyLibrary <span class="keyword">import</span> AisACData</div>
<div class="line"><span class="keyword">from</span> SquidstatPyLibrary <span class="keyword">import</span> AisExperimentNode</div>
<div class="line"><span class="keyword">from</span> SquidstatPyLibrary <span class="keyword">import</span> AisErrorCode</div>
<div class="line"><span class="keyword">from</span> SquidstatPyLibrary <span class="keyword">import</span> AisExperiment</div>
<div class="line"><span class="keyword">from</span> SquidstatPyLibrary <span class="keyword">import</span> AisInstrumentHandler</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md32"></a>
Import experiment modules depeneding on the requirement.</h4>
<div class="fragment"><div class="line">from SquidstatPyLibrary import AisConstantPotElement</div>
<div class="line">from SquidstatPyLibrary import AisEISPotentiostaticElement</div>
<div class="line">from SquidstatPyLibrary import AisConstantCurrentElement</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md33"></a>
Create the custom experiment.</h4>
<div class="fragment"><div class="line">experiment = AisExperiment();</div>
<div class="line">cvElement = AisConstantPotElement(5, 1, 10)</div>
<div class="line">eisElement = AisEISPotentiostaticElement(10000, 1, 10, 0.15, 0.1);</div>
<div class="line">ccElement = AisConstantCurrentElement(1, 1, 10);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">subExperiment = AisExperiment()</div>
<div class="line">subExperiment.appendElement(ccElement, 1);</div>
<div class="line">subExperiment.appendElement(cvElement, 1);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">experiment.appendElement(ccElement,1)</div>
<div class="line">experiment.appendElement(cvElement,1)</div>
<div class="line">experiment.appendSubExperiment(subExperiment, 2)  # Here we repeating sub experiment 2 times</div>
<div class="line">experiment.appendElement(eisElement,1)</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md34"></a>
Get the Instrument Handler and connect the required signal to receive data from the Device.</h4>
<div class="fragment"><div class="line">app = QApplication()</div>
<div class="line"> </div>
<div class="line">tracker = AisDeviceTracker.Instance()</div>
<div class="line"> </div>
<div class="line">tracker.newDeviceConnected.connect(lambda deviceName: print(&quot;Device is Connected: %s&quot; % deviceName))</div>
<div class="line">tracker.connectToDeviceOnComPort(&quot;COM19&quot;)</div>
<div class="line"> </div>
<div class="line">handler = tracker.getInstrumentHandler(&quot;Ace1102&quot;);</div>
<div class="line"> </div>
<div class="line">handler.activeDCDataReady.connect(lambda channel, data: print(&quot;timestamp:&quot;, &quot;{:.9f}&quot;.format(data.timestamp), &quot;workingElectrodeVoltage: &quot;, &quot;{:.9f}&quot;.format(data.workingElectrodeVoltage)))</div>
<div class="line">handler.activeACDataReady.connect(lambda channel, data: print(&quot;frequency:&quot;, &quot;{:.9f}&quot;.format(data.frequency), &quot;absoluteImpedance: &quot;, &quot;{:.9f}&quot;.format(data.absoluteImpedance), &quot;phaseAngle: &quot;, &quot;{:.9f}&quot;.format(data.phaseAngle)))</div>
<div class="line">handler.experimentNewElementStarting.connect(lambda channel, data: print(&quot;New Node beginning:&quot;, data.stepName, &quot;step number: &quot;, data.stepNumber, &quot; step sub : &quot;, data.substepNumber))</div>
<div class="line">handler.experimentStopped.connect(lambda channel : print(&quot;Experiment Completed: %d&quot; % channel))</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">handler.uploadExperimentToChannel(0,experiment)</div>
<div class="line">handler.startUploadedExperiment(0)</div>
<div class="line"> </div>
<div class="line">sys.exit(app.exec_())</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md35"></a>
Full Example</h4>
<p >Here is everything put together. You can also find this in the pythonWrapper directory.</p>
<div class="fragment"><div class="line">import sys</div>
<div class="line">import struct</div>
<div class="line">from PySide2.QtWidgets import QApplication</div>
<div class="line">from SquidstatPyLibrary import AisDeviceTracker</div>
<div class="line">from SquidstatPyLibrary import AisCompRange</div>
<div class="line">from SquidstatPyLibrary import AisDCData</div>
<div class="line">from SquidstatPyLibrary import AisACData</div>
<div class="line">from SquidstatPyLibrary import AisExperimentNode</div>
<div class="line">from SquidstatPyLibrary import AisErrorCode</div>
<div class="line">from SquidstatPyLibrary import AisExperiment</div>
<div class="line">from SquidstatPyLibrary import AisInstrumentHandler</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">from SquidstatPyLibrary import AisConstantPotElement</div>
<div class="line">from SquidstatPyLibrary import AisEISPotentiostaticElement</div>
<div class="line">from SquidstatPyLibrary import AisConstantCurrentElement</div>
<div class="line"> </div>
<div class="line">app = QApplication()</div>
<div class="line"> </div>
<div class="line">tracker = AisDeviceTracker.Instance()</div>
<div class="line"> </div>
<div class="line">tracker.newDeviceConnected.connect(lambda deviceName: print(&quot;Device is Connected: %s&quot; % deviceName))</div>
<div class="line">tracker.connectToDeviceOnComPort(&quot;COM19&quot;)</div>
<div class="line"> </div>
<div class="line">handler = tracker.getInstrumentHandler(&quot;Ace1102&quot;);</div>
<div class="line"> </div>
<div class="line">handler.activeDCDataReady.connect(lambda channel, data: print(&quot;timestamp:&quot;, &quot;{:.9f}&quot;.format(data.timestamp), &quot;workingElectrodeVoltage: &quot;, &quot;{:.9f}&quot;.format(data.workingElectrodeVoltage)))</div>
<div class="line">handler.activeACDataReady.connect(lambda channel, data: print(&quot;frequency:&quot;, &quot;{:.9f}&quot;.format(data.frequency), &quot;absoluteImpedance: &quot;, &quot;{:.9f}&quot;.format(data.absoluteImpedance), &quot;phaseAngle: &quot;, &quot;{:.9f}&quot;.format(data.phaseAngle)))</div>
<div class="line">handler.experimentNewElementStarting.connect(lambda channel, data: print(&quot;New Node beginning:&quot;, data.stepName, &quot;step number: &quot;, data.stepNumber, &quot; step sub : &quot;, data.substepNumber))</div>
<div class="line">handler.experimentStopped.connect(lambda channel : print(&quot;Experiment Completed: %d&quot; % channel))</div>
<div class="line"> </div>
<div class="line">experiment = AisExperiment();</div>
<div class="line">cvElement = AisConstantPotElement(5, 1, 10)</div>
<div class="line">eisElement = AisEISPotentiostaticElement(10000, 1, 10, 0.15, 0.1);</div>
<div class="line">ccElement = AisConstantCurrentElement(1, 1, 10);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">subExperiment = AisExperiment()</div>
<div class="line">subExperiment.appendElement(ccElement, 1);</div>
<div class="line">subExperiment.appendElement(cvElement, 1);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">experiment.appendElement(ccElement,1)</div>
<div class="line">experiment.appendElement(cvElement,1)</div>
<div class="line">experiment.appendSubExperiment(subExperiment, 2)</div>
<div class="line">experiment.appendElement(eisElement,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">handler.uploadExperimentToChannel(0,experiment)</div>
<div class="line">handler.startUploadedExperiment(0)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">sys.exit(app.exec_())</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
