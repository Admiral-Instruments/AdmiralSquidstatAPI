<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <meta name="generator" content="Doxygen 1.12.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- BEGIN opengraph metadata -->
    <meta property="og:image" content="https://admiral-instruments.github.io/AdmiralSquidstatAPI/assets/images/DocumentationPreview.jpeg" />
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="og:title" content="Squidstat API User Manual" />
    <meta property="og:description" content="Squidstat API documentation from Admiral Instruments." />
    <meta property="og:url" content="https://admiral-instruments.github.io/AdmiralSquidstatAPI/" />
    <!-- END opengraph metadata -->
    <!-- BEGIN twitter metadata -->
    <meta name="twitter:image:src" content="https://admiral-instruments.github.io/AdmiralSquidstatAPI/assets/images/DocumentationPreview.jpeg" />
    <meta name="twitter:title" content="Squidstat API User Manual" />
    <meta name="twitter:description" content="Squidstat API documentation from Admiral Instruments" />
    <!-- END twitter metadata -->
    <title>Squidstat API User Manual: Updating Firmware</title>
    <link href="tabs.css" rel="stylesheet" type="text/css" />
    <link rel="icon" type="image/svg+xml" href="logo.drawio.svg" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
    <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
    <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
    <script type="text/javascript" src="toggle-alternative-theme.js"></script>
    <script type="text/javascript">
        DoxygenAwesomeFragmentCopyButton.init()
        DoxygenAwesomeDarkModeToggle.init()
        DoxygenAwesomeParagraphLink.init()
        DoxygenAwesomeInteractiveToc.init()
        DoxygenAwesomeTabs.init()
    </script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Admiral_Instruments_Logo.webp"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__markdown_files_2_firmware_update.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Updating Firmware</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md10"></a></p>
<h2><a class="anchor" id="autotoc_md11"></a>
Introduction</h2>
<p>Each API version includes the necessary firmware for all supported Squidstats to connect properly. When a new API is released, it may include updated firmware with new features or fixes. However, firmware updates are not automatic. They must be initiated manually. A Squidstat wonâ€™t connect to the API until its firmware is compatible. Once updated, the firmware stays on the device until another update is performed. No separate files or tools are needed, and updates are only required when the API version changes.<br  />
This page explains how to detect and handle outdated firmware.</p>
<dl class="section note"><dt>Note</dt><dd>The latest Squidstat API and Squidstat User Interface should always have matching firmware versions for all devices. If switching between them requires a firmware update, please verify that you have both the latest SUI and API.</dd></dl>
<h2><a class="anchor" id="autotoc_md12"></a>
Checking for and Updating Outdated Firmware</h2>
<p>If <a class="el" href="class_ais_device_tracker.html#a3369b0043dd80bd1ab4e23dabe236097">AisDeviceTracker::connectToDeviceOnComPort</a> returns the <a class="el" href="class_ais_error_code.html#aa1d7e88850560cfd6229469c60e3311aaebaf047df011cabf7dfdf13f0c7299e0">AisErrorCode::FirmwareNotSupported</a> error code, a firmware update is required to use the device with the API. Here is an example of how to update the firmware in this scenario. </p><div class="tabbed"><ul>
<li><b class="tab-title">C++</b> <div class="fragment"><div class="line"><span class="preprocessor">#include &quot;AisInstrumentHandler.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;AisDeviceTracker.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;QCoreApplication&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;QThread&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;QDebug&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define COMPORT &quot;COM1&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> args;</div>
<div class="line">    QCoreApplication a(args, <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> tracker = <a class="code hl_function" href="class_ais_device_tracker.html#adc58454bc5bfc76b3c8fc3fad40d2f1c">AisDeviceTracker::Instance</a>();</div>
<div class="line"> </div>
<div class="line">    QObject::connect(tracker, &amp;<a class="code hl_signal" href="class_ais_device_tracker.html#a1f308b1322e75270ce0f0f6c23e5b9ec">AisDeviceTracker::firmwareUpdateNotification</a>, [=](<span class="keyword">const</span> QString&amp; message) {</div>
<div class="line">        qDebug() &lt;&lt; message;</div>
<div class="line">        <span class="keywordflow">if</span> (message.contains(<span class="stringliteral">&quot;firmware is updated.&quot;</span>)) {</div>
<div class="line">            <span class="comment">// Now instrument is ready to go</span></div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Attempt to connect to the device</span></div>
<div class="line">    <span class="keyword">auto</span> error = tracker-&gt;connectToDeviceOnComPort(COMPORT);</div>
<div class="line">    <span class="keywordflow">if</span> (error == <a class="code hl_enumvalue" href="class_ais_error_code.html#aa1d7e88850560cfd6229469c60e3311aaebaf047df011cabf7dfdf13f0c7299e0">AisErrorCode::FirmwareNotSupported</a>) {</div>
<div class="line">        error = tracker-&gt;updateFirmwareOnComPort(COMPORT);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Some other error occured</span></div>
<div class="line">        <span class="keywordflow">if</span> (error != <a class="code hl_enumvalue" href="class_ais_error_code.html#aa1d7e88850560cfd6229469c60e3311aaa21a6da1189d0d65d44581a9f7a6ee04">AisErrorCode::Success</a>) {</div>
<div class="line">            qDebug() &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; error.message();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (error != <a class="code hl_enumvalue" href="class_ais_error_code.html#aa1d7e88850560cfd6229469c60e3311aaa21a6da1189d0d65d44581a9f7a6ee04">AisErrorCode::Success</a>) {</div>
<div class="line">        qDebug() &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; error.message();</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        qDebug() &lt;&lt; <span class="stringliteral">&quot;Device firmware is up to date&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> a.exec();</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li><b class="tab-title">Python</b> <div class="fragment"><div class="line"><span class="keyword">import</span> sys</div>
<div class="line"><span class="keyword">from</span> PySide6.QtWidgets <span class="keyword">import</span> QApplication</div>
<div class="line"> </div>
<div class="line"><span class="keyword">from</span> SquidstatPyLibrary <span class="keyword">import</span> AisDeviceTracker</div>
<div class="line"><span class="keyword">from</span> SquidstatPyLibrary <span class="keyword">import</span> AisInstrumentHandler</div>
<div class="line"><span class="keyword">from</span> SquidstatPyLibrary <span class="keyword">import</span> AisErrorCode</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Define relavant device information, for easy access</span></div>
<div class="line">COMPORT = <span class="stringliteral">&quot;COM16&quot;</span></div>
<div class="line"> </div>
<div class="line">app = QApplication()</div>
<div class="line"> </div>
<div class="line">tracker = <a class="code hl_function" href="class_ais_device_tracker.html#adc58454bc5bfc76b3c8fc3fad40d2f1c">AisDeviceTracker.Instance</a>()</div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span>onProgressMessage(message):</div>
<div class="line">    print(message)</div>
<div class="line">    <span class="keywordflow">if</span> message.__contains__(<span class="stringliteral">&quot;firmware is updated&quot;</span>):</div>
<div class="line">        app.quit()</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">tracker.firmwareUpdateNotification.connect(onProgressMessage)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Attempt to connect to the device</span></div>
<div class="line">error = tracker.connectToDeviceOnComPort(COMPORT)</div>
<div class="line"><span class="keywordflow">if</span> error.value() == AisErrorCode.FirmwareNotSupported:</div>
<div class="line">    error = tracker.updateFirmwareOnComPort(COMPORT)</div>
<div class="line">    </div>
<div class="line">    <span class="comment"># Some other error occured</span></div>
<div class="line">    <span class="keywordflow">if</span> error.value() != AisErrorCode.Success:</div>
<div class="line">        print(f<span class="stringliteral">&quot;Error: {error.message()}&quot;</span>)</div>
<div class="line">        sys.exit()</div>
<div class="line"><span class="keywordflow">elif</span> error.value() != AisErrorCode.Success:</div>
<div class="line">    print(f<span class="stringliteral">&quot;Error: {error.message()}&quot;</span>)</div>
<div class="line">    sys.exit()</div>
<div class="line"><span class="keywordflow">else</span>:</div>
<div class="line">    print(<span class="stringliteral">&quot;Device is already up to date.&quot;</span>)</div>
<div class="line">    sys.exit()</div>
<div class="line">    </div>
<div class="line">sys.exit(app.exec())</div>
</div><!-- fragment --> </li>
</ul>
</div><p>The <a class="el" href="class_ais_device_tracker.html#a1f308b1322e75270ce0f0f6c23e5b9ec">AisDeviceTracker::firmwareUpdateNotification</a> signal will display the progress of the firmware update as a percentage while the instrument is updating. Once the update is complete, this notification will send the message "Firmware is updated", signaling that the instrument can now be connected to the API. </p><div class="tabbed"><ul>
<li><b class="tab-title">C++</b> <div class="fragment"><div class="line">    QObject::connect(tracker, &amp;<a class="code hl_signal" href="class_ais_device_tracker.html#a1f308b1322e75270ce0f0f6c23e5b9ec">AisDeviceTracker::firmwareUpdateNotification</a>, [=](<span class="keyword">const</span> QString&amp; message) {</div>
<div class="line">        qDebug() &lt;&lt; message;</div>
<div class="line">        <span class="keywordflow">if</span> (message.contains(<span class="stringliteral">&quot;firmware is updated.&quot;</span>)) {</div>
<div class="line">            <span class="comment">// Now instrument is ready to go</span></div>
<div class="line">        }</div>
<div class="line">    });</div>
</div><!-- fragment --></li>
<li><b class="tab-title">Python</b> <div class="fragment"><div class="line">tracker.firmwareUpdateNotification.connect(onProgressMessage)</div>
</div><!-- fragment --> </li>
</ul>
</div><p>See the full example <a href="firmware_update_8cpp-example.html">here</a></p>
<p>Note that we check the <a class="el" href="class_ais_error_code.html">AisErrorCode</a> first before performing the firmware update. Alternatively, you can use <a class="el" href="class_ais_device_tracker.html#a9a42add8e62f171ef0280b8df3c3beed">AisDeviceTracker::updateFirmwareOnAllAvailableDevices</a> all connected devices that require an update.</p>
<div class="section_buttons"> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Previous   </th><th class="markdownTableHeadRight">Next    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="md__markdown_files_2_guided_examples_intro.html">Guided Examples</a>   </td><td class="markdownTableBodyRight"><a class="el" href="md__markdown_files_2_run_experiment.html">Running an Experiment</a>   </td></tr>
</table>
</div> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
